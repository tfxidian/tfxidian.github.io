---
title: C++面向对象高级编程（3）构造函数
date: 2021-09-20 9:55:50
tags: C++
layout: post
---



### 访问级别

![](https://github.com/tfxidian/tfxidian.github.io/raw/master/pic/access_level.PNG)

| public                     | protected | private |      |
| -------------------------- | --------- | ------- | ---- |
| 类成员是否可以访问         | Yes       | Yes     | Yes  |
| 友元函数是否可以访问       | Yes       | Yes     | Yes  |
| 子类是否可以访问           | Yes       | Yes     | No   |
| 类的实例化对象是否可以访问 | Yes       | No      | No   |

简单总结：

- 首先类本身对于自己的所有成员肯定是有访问权限的，无论是public、protect还是private
- **类的实例化对象只对类的public成员有访问权限**
- protect相比private成员的特别之处在于，protect对于派生类是可访问（或可见）的，而private成员在派生类中不可见。

在类的设计时：

- 将成员声明成public是为了让类的（实例化）对象与派生类能够访问；
- **将成员声明成protect是为了让类的对象不可访问，而派生类可以访问**；
- 将成员声明成private则是为了只让类本身可以访问，其对象与派生类均不可访问；

无论声明成哪种，类本身对于其成员都是有访问权限的。



重点：以前我没有很好的区分类和类的对象的访问权限问题，现在发现区别还是相当大的。



### 构造函数

#### 初始化（初值列）

```C++
class complex{

public:
    complex(T r = 0, T i = 0)
        :re(r),im(i)
    { }

private:
    T re, im;
};

```

**初值列**：

数值的设定有两个阶段：第一个就是初值列，第二个就是可以在大括号里面设定，尽量在初值列就设定，避免浪费这样一个机会。

```C++
    complex(T r = 0, T i = 0)
        :re(r),im(i)
    { }
```

另一种方法：

```C++
    complex(T r = 0, T i = 0)
    {
    	re = r;
    	im = i;
    }
```



### 创建对象

```C++
complex c1(2,1);

complex c2;

complex *p = new complex(4);
```

不带指针的类多半不需要写析构函数。



### 默认构造函数和构造函数重载

首先需要了解构造函数是用来做什么？该类对象被创建时，编译器为对象分配内存空间，并自动调用该构造函数，由构造函数完成数据成员的初始化工作。

#### 默认构造函数

不带参数或者参数有默认值的构造函数就是默认构造函数

```c++
class testClass {
public :
    testClass();//不带参数的默认构造函数---------
    testClass(int a, char b);//构造函数
    testClass(int a = 0, char b = 'c');//参数都有默认值的默认构造函数-------

private:
    int m_a;
    char m_b;
};
```

默认构造函数主要用来完成如下形式的初始化。

```C++
testClass classA；
//或者
testClass *classA = new testClass;
```

在这种情况下，如果没有提供默认构造函数也就是以上两种默认构造函数其中的一种，编译器会报错。

两种方式的默认构造函数

- 定义一个无参数的构造函数；
- 定义所有参数都有默认值得构造函数。

注意：**一个类只能有一个默认构造函数**。也就是说上述两种方式定义的默认构造函数不能同时出现，一般选择testClass();这种形式的默认构造函数。只有程序员定义了构造函数，编译器就不会再提供默认构造函数了。所以程序员最好再手动定义一个默认构造函数，以防止出现testClass classA;这样的错误。


C++ 默认构造函数是对类中的参数提供默认值的构造函数，一般情况下，是一个没有参数值的空函数，也可以提供一些的默认值的构造函数，如果用户没有定义构造函数，那么编译器会给类提供一个默认的构造函数，但是**只要用户自定义了任意一个构造函数，那么编译器就不会提供默认的构造函数，这种情况下，容易编译报错，所以正确的写法就是用户在定义构造函数的时候，也需要添加一个默认的构造函数，这样就不会造成编译报错。**

